<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.order">
	<resultMap id="orderGoodsResult"
		type="com.book.order.vo.OrderVO">
		<result property="order_seq_num" column="order_seq_num" />
		<result property="order_id" column="order_id" />
		<result property="goods_id" column="goods_id" />
		<result property="goods_title" column="goods_title" />
		<result property="goods_price" column="goods_price" />
		<result property="goods_fileName" column="goods_fileName" />
		<result property="order_goods_qty" column="goods_qty" />
		<result property="delivery_state" column="delivery_state" />

		<result property="member_id" column="member_id" />
		<result property="order_hp" column="order_hp" />

		<result property="receiver_name" column="receiver_name" />
		<result property="receiver_hp1" column="receiver_hp1" />
		<result property="delivery_address" column="delivery_address" />
		<result property="pay_method" column="pay_method" />
		<result property="card_com_name" column="card_com_name" />
		<result property="pay_order_hp_num" column="pay_order_hp_num" />
		<result property="card_pay_month" column="card_pay_month" />
		<result property="pay_order_time" column="pay_order_time" />
	</resultMap>


	<insert id="insertNewOrder" parameterType="orderVO">
    <![CDATA[
		INSERT INTO t_shopping_order(
			order_id,
			goods_id,
			goods_title,
			goods_price,
			goods_fileName,
			order_goods_qty,
			member_id,
			order_hp,
			receiver_name,
			receiver_hp1,
			delivery_address,
			pay_method,
			card_com_name,
			card_pay_month,
			pay_order_hp_num
		)
		VALUES (
				   #{order_id},
				   #{goods_id},
				   #{goods_title},
				   #{goods_price},
				   #{goods_fileName},
				   #{order_goods_qty},
				   #{member_id},
				   #{order_hp},
				   #{receiver_name},
				   #{receiver_hp1},
				   #{delivery_address},
				   #{pay_method},
				   #{card_com_name},
				   #{card_pay_month},
				   #{pay_order_hp_num}
			   );
		SELECT LAST_INSERT_ID();
		]]>
</insert>
	<!-- 주문번호 시퀀스를 생성 -->
	<!-- 주문번호 시퀀스를 생성하여 결과값을 반환한다. -->
	<select id="selectOrderID" resultType="int">
		SELECT LAST_INSERT_ID();
	</select>





	<!-- 주문완료시 장바구니에서 상품 제거 -->
	<delete id="deleteGoodsFromCart" parameterType="orderVO">
		DELETE FROM t_shopping_cart
		WHERE goods_id = #{goods_id};
	</delete>



</mapper>